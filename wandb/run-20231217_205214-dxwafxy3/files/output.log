/ssd5/CVPR2023comp/track1_train_data/det_yolov6/labels/train
/ssd5/CVPR2023comp/track1_train_data/det_yolov6/labels/val
use effidet
Initializing Detect head...
initial...
################################################################################
Train: Final numbers of valid images: 5493/ labels: 5493.
0.2s for dataset initialization.
Convert to COCO format
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 610/610 [00:00<00:00, 124605.53it/s]
Convert to COCO format finished. Resutls saved in /ssd5/CVPR2023comp/track1_train_data/det_yolov6/annotations/instances_val.json
Val: Final numbers of valid images: 610/ labels: 610.
0.1s for dataset initialization.
Traceback (most recent call last):
  File "tools/train.py", line 176, in <module>
    main(args)
  File "tools/train.py", line 157, in main
    trainer = Trainer(args, cfg, device)
  File "/home/re6101029/CVPR2023comp/yolov6/yolov6/core/engine.py", line 155, in __init__
    model = self.get_model(args, cfg, self.num_classes, device)
  File "/home/re6101029/CVPR2023comp/yolov6/yolov6/core/engine.py", line 611, in get_model
    model = build_model(cfg, nc, device, fuse_ab=self.args.fuse_ab, distill_ns=self.distill_ns)
  File "/home/re6101029/CVPR2023comp/yolov6/yolov6/models/yolo.py", line 139, in build_model
    model = Model(cfg, channels=3, num_classes=num_classes, fuse_ab=fuse_ab, distill_ns=distill_ns).to(device)
  File "/home/re6101029/miniconda3/envs/CVPR/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/re6101029/CVPR2023comp/yolov6/yolov6/models/yolo.py", line 43, in _apply
    self = super()._apply(fn)
  File "/home/re6101029/miniconda3/envs/CVPR/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/re6101029/miniconda3/envs/CVPR/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/re6101029/miniconda3/envs/CVPR/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/re6101029/miniconda3/envs/CVPR/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/re6101029/miniconda3/envs/CVPR/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.